# 电赛报告



## 系统理论分析与计算

### 系统结构的分析

1. 系统理论：通过对题目的分析，板球控制系统是一个闭环的控制系统，需要控制的是小球的点位，而小球的点位是通过控制舵机的旋转以及自己设计的连接结构使板子具有算法处理后的角度。本系统采用pid的算法进行工作，由openmv识别小球，返回小球的点坐标，通过小球的坐标，分别对x,y轴两个方向进行pid算法的计算，计算后根据结果改变控制x,y轴方向舵机的pwm占空比从而让板子偏转，控制小球的位置。

2. openmv识别方案：主要的识别方案为通过形状识别和通过寻找色块，经过比较我们发现，使用颜色来识别的准确率更高，且受光线影响较小，帧率更高，最后我们采用的是寻找色块来确定小球位置。

3. pid算法的计算：根据测试发现当我们在pid算法中加入i这一积分环节的时候，系统会变得不稳定且难以平衡；而当我们删掉了积分环节时，小球又会停在我们设定的点的旁边（这是由于板子无法做到绝对平衡的原因引起的，这也是本题的难点）。于是我们采用的方案为:

   (1) 只有当小球停止移动且不在设定的点位范围之内之后，才开启积分环节，给小球一个正确方向的偏移，让小球进入正确的点位

   (2) 为每个点位设置一个平衡点，因为我们板子并不是每一个地方都是平的，特别是四周的地方可能会产生向下的角度，这也会导致小球的停留点偏移，所以我们为每个小球采取了9套不同的平衡板子的舵机pwm，让他们适应九个点的平板角度。

   (3) 为9个点分别设置9套不同的pid，且额外多加一套pid适用于变换点位。我们在测试的过程中，除去i环节，我们在pd的环节也发现了问题，有些点位采用降低kp(error的比例系数)的方式，更好进入我们的点位，而对于一些位置，他们那个地方的板子如果是凸起或者有肉眼不可见的凹凸的话，就会出现进不去点位的状况，需要提高kp，于是我们出现了这样的情况，调好了一个点位pid后，切换到另一个点调pid,之前那个点又进不去了，或者在换点位置的时候刹不住车，冲出板子外面。最后我们采用的方案是为9个点分别设置9套不同的pid，且额外多加一套pid适用于变换点位。

   

   

## 系统方案论证（补充）

### 控制系统的方案的论证与选择

方案一：采用步进电机，转动的角度比较准确，控制较为简单，但是无法每次启动归位，需要每次启动时调平。

方案二：采用MG90R舵机，转动角度精细，pwm波控制转动角度180满足需求，且开机会自动复位，不需要每次启动调平。

综合上述方案，选择方案二。





